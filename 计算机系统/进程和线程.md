# 什么是进程

进程是资源分配的基本单位

在操作系统中,分配资源是以进程来划分的

# 什么是线程

线程是独立调度的基本单位

在每一个进程中都有至少一个线程,他们对进程的资源是共享的

比如浏览器中,浏览器是一个进程,但是浏览器中会有比如HTTP请求线程,事件响应线程,渲染管线线程等等,线程可以并发地进行

![](http://imageblog.boyn.top/202002012126_22.png)

# 进程与线程的区别

1. 进程是资源分配的基本单位,而线程不实际拥有资源,而是多个线程共享进程的资源
2. 线程是独立调度的基本单位,在一个进程内,线程之间的切换不会引起进程的切换,但是从一个进程到另一个进程的调度会引起进程的上下文切换
3. 进程切换时,要保存当前CPU信息,环境等,并设置下一个进程的CPU信息与环境,开销比较大,而相比于进程,线程切换的开销只需要一些寄存器的切换即可,开销比较小
4. 线程之间可以通过共同读取进程内的资源实现通信,但是进程间的通信会复杂得多

# 进程的几个状态

![](http://imageblog.boyn.top/202002012130_683.png)

进程有许多的状态,从被创建到终止

1. Ready: 就绪状态.等待被调度
2. Running: 运行状态
3. Waiting: 接收到IO请求或者事件等待请求

# 进程调度算法

在我们常用的交互式系统下,主要有三种进程调度的方法

## 时间片轮转

这个是最简单的算法,给每个进程固定的时间片,在这段时间内进程处于运行状态,而过了这一段时间之后进程就会被切换,转移到下一个进程运行

实际上,会将所有就绪的线程排成一个队列,每次调度的时候将CPU时间分配给队首,执行一个时间片,时间到了之后由计时器发出中断,调度程度会结束这个程序的运行,将他送往队尾,并将时间片分配给新的队首进程

![](http://imageblog.boyn.top/202002012153_851.png)

如果时间片太短,那么进程的切换就会过于频繁从而导致花费了更多的时间在切换而不是进程的实际运行上.

如果时间片太长,那么进程的实时性就得不到保障

## 优先级调度

为所有的进程分配一个优先级,并将其放置入一个优先级队列中,按照优先级来进行调度

为了防止"饥饿"现象的出现,可以随着时间推进增加低优先级进程的优先级

## 多级反馈队列

一个进程需要执行 100 个时间片，如果采用时间片轮转调度算法，那么需要交换 100 次。

多级队列是为这种需要连续执行多个时间片的进程考虑，它设置了多个队列，每个队列时间片大小都不同，例如 1,2,4,8,..。进程在第一个队列没执行完，就会被移到下一个队列。这种方式下，之前的进程只需要交换 7 次。

每个队列优先权也不同，最上面的优先权最高。因此只有上一个队列没有进程在排队，才能调度当前队列上的进程。

可以将这种调度算法看成是时间片轮转调度算法和优先级调度算法的结合。

![](http://imageblog.boyn.top/202002012155_604.png)

# 进程同步

1. 临界区
2. 同步与互斥
3. 信号量
4. 管程

# 进程间通信

进程同步与进程通信很容易混淆，它们的区别在于：

- 进程同步：控制多个进程按一定顺序执行；
- 进程通信：进程间传输信息。

进程通信是一种手段，而进程同步是一种目的。也可以说，为了能够达到进程同步的目的，需要让进程进行通信，传输一些进程同步所需要的信息。

## 管道

即匿名管道,实现了进程之间的半双工通信,是单向交替传输的,只能够用于父子进程或者兄弟进程

图为兄弟进程间通过匿名管道进行通信

![](http://imageblog.boyn.top/202002012157_904.png)

## FIFO

也称为命名管道,可以在任意进程之间传输数据

![](http://imageblog.boyn.top/202002012158_466.png)

## 消息队列

相比于 FIFO，消息队列具有以下优点：

- 消息队列可以独立于读写进程存在，从而避免了 FIFO 中同步管道的打开和关闭时可能产生的困难；
- 避免了 FIFO 的同步阻塞问题，不需要进程自己提供同步方法；
- 读进程可以根据消息类型有选择地接收消息，而不像 FIFO 那样只能默认地接收。

## 共享存储

给定一个存储区,可以使多个进程对这个区域进行读写,由于不设限制,所以通常需要使用信号量的手段来同步进程,规划其访问的顺序

## 套接字

套接字可以用于网络之间的通信