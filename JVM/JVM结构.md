# 什么是JVM?

JVM是一个提供驱动Java程序的运行时环境的引擎,将字节码文件解释为机器语言,是JRE的一部分.

# JVM如何工作

我们在编写好了Java代码之后,通常会使用`javac`程序将其编译为字节码,这一部分是JDK的工作,没有JVM进行参与.而我们在运行字节码文件(.class文件)的时候,是使用`java`文件进行运行的,这个时候JVM会加载class文件进入其中,然后提交给执行引擎进行执行

![](http://imageblog.boyn.top/202001311123_445.png)

# JVM结构

JVM整体结构如下

![](http://imageblog.boyn.top/202001311125_763.png)

## 类加载器

关于[类加载机制](类加载.md),可以看这篇文章

类加载器是用于加载类文件,过程包括加载,连接,初始化

## 方法区

方法区用于存储类结构元信息,常量池与JIT编译之后的代码信息.它是线程共享的,它是堆中的一个逻辑部分,可以认为是堆中的特殊数据,称为永久代,不会被GC

## 堆

对于大部分Java应用,堆用于存放对象的实例,对象实例在堆中进行内存的分配,是线程共享的

## JVM栈

JVM栈是线程私有的,它用于描述JMM结构,每一个方法在执行的时候都会创建一个栈帧,用于存储局部变量表,操作数栈,动态链接,方法出口等等信息,每一个方法执行与退出,对应JVM栈上面入栈与出栈的过程

## 程序计数器(PC)

PC是线程私有的,看作是当前线程所执行的字节码的行号指示器

## 本地方法栈

本地方法栈与JVM栈结构相似,不过它记录的是本地方法库中被调用的方法,基本上是C++写的

## 执行引擎

具体执行器

## 本地方法接口

JMI是一个程序框架,可以使Java调用其他语言(C/C++)的库和本地应用

## 本地方法库

执行所需的C/C++方法